using System.Collections.Generic;
using Nop.Core.Domain.Payments;
using System;
using NopTop.Plugin.Payments.Zarinpal.Models;

namespace NopTop.Plugin.Payments.Zarinpal
{
    /// <summary>
    /// Represents Zarinpal helper
    /// </summary>
    public class ZarinpalHelper
    {
        public static string ProduceRedirectUrl(string StoreLocation, int? status, bool UseSandbox, string Authority, string ZarinGate)
        {
            string urlProduced = (status.HasValue && status.Value == 100 ?
                                string.Concat($"https://{(UseSandbox ? "sandbox" : "www")}.zarinpal.com/pg/StartPay/",
                                Authority, ZarinGate)
                               : string.Concat(StoreLocation, "Plugins/PaymentZarinpal/ErrorHandler", "?Error=",
                                ZarinpalHelper.StatusToMessage(status).Message)
                                );
            var uri = new Uri(urlProduced);
            return uri.AbsoluteUri;
        }
        public static StatusToResult StatusToMessage(int? _status)
        {
            StatusToResult statusToResult = new StatusToResult();
            switch (_status)
            {
                case -1:
                    statusToResult.Message = "اطلاعات ارسال شده ناقص است.";
                    break;
                case -2:
                    statusToResult.Message = "آی پی و مرچنت کد پذیرنده صحیح نمی باشد";
                    break;
                case -3:
                    statusToResult.Message = "امکان پرداخت مبلغ درخواست شده میسر نمی باشد";
                    break;
                case -4:
                    statusToResult.Message = "سطح تایید پذیرنده پایین تر از نقره ای می باشد";
                    break;
                case -11:
                    statusToResult.Message = "درخواست مورد نظر یافت نشد.";
                    break;
                case -12:
                    statusToResult.Message = "امکان ویرایش درخواست میسر نمی باشد";
                    break;
                case -21:
                    statusToResult.Message = "انصراف از خرید";
                    break;
                case -22:
                    statusToResult.Message = "تراکنش ناموفق می باشد.";
                    break;
                case -33:
                    statusToResult.Message = "مبلغ تراکنش با مبلغ پرداخت شده مطابقت ندارد.";
                    break;
                case -34:
                    statusToResult.Message = "سقف تقسیم تراکنش از لحاظ تعداد یا رقم عبور نموده است";
                    break;
                case -40:
                    statusToResult.Message = "اجازه دسترسی به متد مبروطه وجود ندارد";
                    break;
                case -41:
                    statusToResult.Message = "اجازه ارسال شده مربوط به Additional Data غیر معتبر می باشد";
                    break;
                case -42:
                    statusToResult.Message = "مدت زمان معتبر طول شناسه پرداخت باید بین 30 دقیقه تا 45 روز می باشد";
                    break;
                case -54:
                    statusToResult.Message = "درخواست مورد نظر آرشیو شده است";
                    break;
                case 100:
                    statusToResult.IsOk = true;
                    statusToResult.Message = "تراکنش با موفقیت انجام شد";
                    break;
                case 101:
                    statusToResult.IsOk = true;
                    statusToResult.Message = "تراکنش با موفقیت انجام شد و Payment Verification قبلا انجام شده است";
                    break;
                default:
                    statusToResult.Message = string.Concat("درخواست نا معتبر", "-", _status);
                    break;
            }
            return statusToResult;
        }
        static bool isFilled = false;
        static IPList ranges = new IPList();
        public static bool isOverseaseIp(System.Net.IPAddress RemoteIpAddress)
        {
            if (!isFilled)
            {
                ranges.AddRange("2.144.0.0", "2.147.255.255");
                ranges.AddRange("2.176.0.0", "2.191.255.255");
                ranges.AddRange("5.22.0.0", "5.22.127.255");
                ranges.AddRange("5.22.192.0", "5.22.223.255");
                ranges.AddRange("5.34.192.0", "5.34.223.255");
                ranges.AddRange("5.52.0.0", "5.52.255.255");
                ranges.AddRange("5.53.32.0", "5.53.63.255");
                ranges.AddRange("5.62.160.0", "5.62.191.255");
                ranges.AddRange("5.62.192.0", "5.62.255.255");
                ranges.AddRange("5.72.0.0", "5.72.255.255");
                ranges.AddRange("5.73.0.0", "5.73.255.255");
                ranges.AddRange("5.74.0.0", "5.74.255.255");
                ranges.AddRange("5.75.0.0", "5.75.127.255");
                ranges.AddRange("5.75.128.0", "5.75.255.255");
                ranges.AddRange("5.78.0.0", "5.78.255.255");
                ranges.AddRange("5.106.0.0", "5.106.255.255");
                ranges.AddRange("5.112.0.0", "5.127.255.255");
                ranges.AddRange("5.134.128.0", "5.134.191.255");
                ranges.AddRange("5.160.0.0", "5.160.255.255");
                ranges.AddRange("5.161.0.0", "5.161.127.255");
                ranges.AddRange("5.161.128.0", "5.161.255.255");
                ranges.AddRange("5.190.0.0", "5.190.255.255");
                ranges.AddRange("5.198.160.0", "5.198.191.255");
                ranges.AddRange("5.200.64.0", "5.200.95.255");
                ranges.AddRange("5.200.96.0", "5.200.127.255");
                ranges.AddRange("5.200.128.0", "5.200.255.255");
                ranges.AddRange("5.201.128.0", "5.201.255.255");
                ranges.AddRange("5.202.0.0", "5.202.255.255");
                ranges.AddRange("5.208.0.0", "5.209.255.255");
                ranges.AddRange("5.210.0.0", "5.210.255.255");
                ranges.AddRange("5.211.0.0", "5.211.255.255");
                ranges.AddRange("5.212.0.0", "5.213.255.255");
                ranges.AddRange("5.214.0.0", "5.215.255.255");
                ranges.AddRange("5.216.0.0", "5.217.255.255");
                ranges.AddRange("5.218.0.0", "5.218.255.255");
                ranges.AddRange("5.219.0.0", "5.219.63.255");
                ranges.AddRange("5.219.64.0", "5.219.127.255");
                ranges.AddRange("5.219.128.0", "5.219.191.255");
                ranges.AddRange("5.219.192.0", "5.219.255.255");
                ranges.AddRange("5.220.0.0", "5.223.255.255");
                ranges.AddRange("5.232.0.0", "5.239.255.255");
                ranges.AddRange("5.250.0.0", "5.250.127.255");
                ranges.AddRange("31.2.128.0", "31.2.255.255");
                ranges.AddRange("31.7.64.0", "31.7.95.255");
                ranges.AddRange("31.7.96.0", "31.7.127.255");
                ranges.AddRange("31.7.128.0", "31.7.143.255");
                ranges.AddRange("31.14.80.0", "31.14.95.255");
                ranges.AddRange("31.14.112.0", "31.14.127.255");
                ranges.AddRange("31.14.144.0", "31.14.159.255");
                ranges.AddRange("31.29.32.0", "31.29.63.255");
                ranges.AddRange("31.47.32.0", "31.47.63.255");
                ranges.AddRange("31.56.0.0", "31.59.255.255");
                ranges.AddRange("31.130.176.0", "31.130.191.255");
                ranges.AddRange("31.170.48.0", "31.170.63.255");
                ranges.AddRange("31.184.128.0", "31.184.191.255");
                ranges.AddRange("31.193.144.0", "31.193.159.255");
                ranges.AddRange("37.19.80.0", "37.19.95.255");
                ranges.AddRange("37.27.0.0", "37.27.255.255");
                ranges.AddRange("37.32.0.0", "37.32.31.255");
                ranges.AddRange("37.32.112.0", "37.32.127.255");
                ranges.AddRange("37.63.128.0", "37.63.255.255");
                ranges.AddRange("37.98.0.0", "37.98.127.255");
                ranges.AddRange("37.114.192.0", "37.114.255.255");
                ranges.AddRange("37.128.240.0", "37.128.255.255");
                ranges.AddRange("37.129.0.0", "37.129.255.255");
                ranges.AddRange("37.137.0.0", "37.137.255.255");
                ranges.AddRange("37.148.0.0", "37.148.127.255");
                ranges.AddRange("37.152.160.0", "37.152.191.255");
                ranges.AddRange("37.153.176.0", "37.153.191.255");
                ranges.AddRange("37.156.16.0", "37.156.31.255");
                ranges.AddRange("37.156.48.0", "37.156.63.255");
                ranges.AddRange("37.156.112.0", "37.156.127.255");
                ranges.AddRange("37.156.128.0", "37.156.143.255");
                ranges.AddRange("37.191.64.0", "37.191.95.255");
                ranges.AddRange("37.202.128.0", "37.202.255.255");
                ranges.AddRange("37.221.0.0", "37.221.63.255");
                ranges.AddRange("37.235.16.0", "37.235.31.255");
                ranges.AddRange("37.254.0.0", "37.255.255.255");
                ranges.AddRange("46.21.80.0", "46.21.95.255");
                ranges.AddRange("46.32.0.0", "46.32.31.255");
                ranges.AddRange("46.34.96.0", "46.34.127.255");
                ranges.AddRange("46.34.176.0", "46.34.191.255");
                ranges.AddRange("46.36.96.0", "46.36.127.255");
                ranges.AddRange("46.38.128.0", "46.38.159.255");
                ranges.AddRange("46.41.192.0", "46.41.255.255");
                ranges.AddRange("46.51.0.0", "46.51.127.255");
                ranges.AddRange("46.62.128.0", "46.62.255.255");
                ranges.AddRange("46.100.0.0", "46.100.255.255");
                ranges.AddRange("46.102.128.0", "46.102.143.255");
                ranges.AddRange("46.143.0.0", "46.143.63.255");
                ranges.AddRange("46.143.64.0", "46.143.127.255");
                ranges.AddRange("46.143.128.0", "46.143.191.255");
                ranges.AddRange("46.143.192.0", "46.143.255.255");
                ranges.AddRange("46.148.32.0", "46.148.47.255");
                ranges.AddRange("46.164.64.0", "46.164.127.255");
                ranges.AddRange("46.167.128.0", "46.167.159.255");
                ranges.AddRange("46.209.0.0", "46.209.255.255");
                ranges.AddRange("46.224.0.0", "46.225.255.255");
                ranges.AddRange("46.245.0.0", "46.245.127.255");
                ranges.AddRange("46.248.32.0", "46.248.63.255");
                ranges.AddRange("46.249.96.0", "46.249.111.255");
                ranges.AddRange("46.251.160.0", "46.251.191.255");
                ranges.AddRange("62.60.128.0", "62.60.255.255");
                ranges.AddRange("62.102.128.0", "62.102.143.255");
                ranges.AddRange("62.193.0.0", "62.193.31.255");
                ranges.AddRange("62.220.96.0", "62.220.127.255");
                ranges.AddRange("66.79.96.0", "66.79.127.255");
                ranges.AddRange("77.36.128.0", "77.36.255.255");
                ranges.AddRange("77.42.0.0", "77.42.63.255");
                ranges.AddRange("77.42.64.0", "77.42.127.255");
                ranges.AddRange("77.77.64.0", "77.77.127.255");
                ranges.AddRange("77.81.32.0", "77.81.47.255");
                ranges.AddRange("77.81.144.0", "77.81.159.255");
                ranges.AddRange("77.81.192.0", "77.81.223.255");
                ranges.AddRange("77.104.64.0", "77.104.127.255");
                ranges.AddRange("77.237.64.0", "77.237.95.255");
                ranges.AddRange("77.237.160.0", "77.237.191.255");
                ranges.AddRange("77.238.112.0", "77.238.127.255");
                ranges.AddRange("77.245.224.0", "77.245.239.255");
                ranges.AddRange("78.38.0.0", "78.39.255.255");
                ranges.AddRange("78.109.192.0", "78.109.207.255");
                ranges.AddRange("78.110.112.0", "78.110.127.255");
                ranges.AddRange("78.111.0.0", "78.111.15.255");
                ranges.AddRange("78.154.32.0", "78.154.63.255");
                ranges.AddRange("78.157.32.0", "78.157.63.255");
                ranges.AddRange("78.158.160.0", "78.158.191.255");
                ranges.AddRange("79.127.0.0", "79.127.127.255");
                ranges.AddRange("79.132.208.0", "79.132.223.255");
                ranges.AddRange("79.175.128.0", "79.175.191.255");
                ranges.AddRange("80.66.176.0", "80.66.191.255");
                ranges.AddRange("80.69.240.0", "80.69.255.255");
                ranges.AddRange("80.71.112.0", "80.71.127.255");
                ranges.AddRange("80.75.0.0", "80.75.15.255");
                ranges.AddRange("80.191.0.0", "80.191.255.255");
                ranges.AddRange("80.210.0.0", "80.210.63.255");
                ranges.AddRange("80.210.128.0", "80.210.255.255");
                ranges.AddRange("80.242.0.0", "80.242.15.255");
                ranges.AddRange("80.250.192.0", "80.250.207.255");
                ranges.AddRange("80.253.128.0", "80.253.143.255");
                ranges.AddRange("80.253.144.0", "80.253.159.255");
                ranges.AddRange("81.12.0.0", "81.12.127.255");
                ranges.AddRange("81.16.112.0", "81.16.127.255");
                ranges.AddRange("81.28.32.0", "81.28.47.255");
                ranges.AddRange("81.28.48.0", "81.28.63.255");
                ranges.AddRange("81.29.240.0", "81.29.255.255");
                ranges.AddRange("81.31.160.0", "81.31.175.255");
                ranges.AddRange("81.31.176.0", "81.31.191.255");
                ranges.AddRange("81.31.224.0", "81.31.255.255");
                ranges.AddRange("81.90.144.0", "81.90.159.255");
                ranges.AddRange("81.91.128.0", "81.91.143.255");
                ranges.AddRange("81.91.144.0", "81.91.159.255");
                ranges.AddRange("82.97.224.0", "82.97.255.255");
                ranges.AddRange("82.99.192.0", "82.99.255.255");
                ranges.AddRange("82.115.16.0", "82.115.31.255");
                ranges.AddRange("83.120.0.0", "83.123.255.255");
                ranges.AddRange("83.147.192.0", "83.147.255.255");
                ranges.AddRange("84.47.192.0", "84.47.223.255");
                ranges.AddRange("84.47.240.0", "84.47.255.255");
                ranges.AddRange("84.241.0.0", "84.241.63.255");
                ranges.AddRange("85.9.64.0", "85.9.127.255");
                ranges.AddRange("85.15.0.0", "85.15.63.255");
                ranges.AddRange("85.133.128.0", "85.133.255.255");
                ranges.AddRange("85.185.0.0", "85.185.255.255");
                ranges.AddRange("85.198.0.0", "85.198.63.255");
                ranges.AddRange("85.204.80.0", "85.204.95.255");
                ranges.AddRange("85.204.208.0", "85.204.223.255");
                ranges.AddRange("85.239.192.0", "85.239.223.255");
                ranges.AddRange("86.55.0.0", "86.55.255.255");
                ranges.AddRange("86.57.0.0", "86.57.127.255");
                ranges.AddRange("86.104.32.0", "86.104.47.255");
                ranges.AddRange("86.104.80.0", "86.104.95.255");
                ranges.AddRange("86.104.96.0", "86.104.111.255");
                ranges.AddRange("86.105.128.0", "86.105.143.255");
                ranges.AddRange("86.107.0.0", "86.107.15.255");
                ranges.AddRange("86.107.80.0", "86.107.95.255");
                ranges.AddRange("86.107.144.0", "86.107.159.255");
                ranges.AddRange("86.107.208.0", "86.107.223.255");
                ranges.AddRange("86.109.32.0", "86.109.63.255");
                ranges.AddRange("87.107.0.0", "87.107.255.255");
                ranges.AddRange("87.247.160.0", "87.247.191.255");
                ranges.AddRange("87.248.128.0", "87.248.159.255");
                ranges.AddRange("87.251.128.0", "87.251.159.255");
                ranges.AddRange("89.32.0.0", "89.32.31.255");
                ranges.AddRange("89.32.96.0", "89.32.111.255");
                ranges.AddRange("89.34.32.0", "89.34.63.255");
                ranges.AddRange("89.34.128.0", "89.34.159.255");
                ranges.AddRange("89.36.48.0", "89.36.63.255");
                ranges.AddRange("89.36.96.0", "89.36.111.255");
                ranges.AddRange("89.36.176.0", "89.36.191.255");
                ranges.AddRange("89.37.0.0", "89.37.15.255");
                ranges.AddRange("89.37.240.0", "89.37.255.255");
                ranges.AddRange("89.38.80.0", "89.38.95.255");
                ranges.AddRange("89.40.240.0", "89.40.255.255");
                ranges.AddRange("89.41.192.0", "89.41.223.255");
                ranges.AddRange("89.41.224.0", "89.41.239.255");
                ranges.AddRange("89.43.0.0", "89.43.15.255");
                ranges.AddRange("89.45.48.0", "89.45.63.255");
                ranges.AddRange("89.47.64.0", "89.47.79.255");
                ranges.AddRange("89.47.128.0", "89.47.159.255");
                ranges.AddRange("89.144.128.0", "89.144.191.255");
                ranges.AddRange("89.165.0.0", "89.165.127.255");
                ranges.AddRange("89.184.192.0", "89.184.223.255");
                ranges.AddRange("89.196.0.0", "89.196.255.255");
                ranges.AddRange("89.198.0.0", "89.198.127.255");
                ranges.AddRange("89.198.128.0", "89.198.255.255");
                ranges.AddRange("89.199.0.0", "89.199.255.255");
                ranges.AddRange("89.219.64.0", "89.219.127.255");
                ranges.AddRange("89.219.192.0", "89.219.255.255");
                ranges.AddRange("89.221.80.0", "89.221.95.255");
                ranges.AddRange("89.235.80.0", "89.235.95.255");
                ranges.AddRange("89.235.96.0", "89.235.127.255");
                ranges.AddRange("91.98.0.0", "91.99.255.255");
                ranges.AddRange("91.106.64.0", "91.106.95.255");
                ranges.AddRange("91.107.128.0", "91.107.255.255");
                ranges.AddRange("91.108.128.0", "91.108.159.255");
                ranges.AddRange("91.133.128.0", "91.133.255.255");
                ranges.AddRange("91.147.64.0", "91.147.79.255");
                ranges.AddRange("91.184.64.0", "91.184.79.255");
                ranges.AddRange("91.184.80.0", "91.184.95.255");
                ranges.AddRange("91.185.128.0", "91.185.159.255");
                ranges.AddRange("91.186.192.0", "91.186.223.255");
                ranges.AddRange("91.243.160.0", "91.243.175.255");
                ranges.AddRange("91.250.224.0", "91.250.239.255");
                ranges.AddRange("91.251.0.0", "91.251.255.255");
                ranges.AddRange("92.50.0.0", "92.50.63.255");
                ranges.AddRange("92.61.176.0", "92.61.191.255");
                ranges.AddRange("92.62.176.0", "92.62.191.255");
                ranges.AddRange("92.114.16.0", "92.114.31.255");
                ranges.AddRange("92.114.64.0", "92.114.79.255");
                ranges.AddRange("92.242.192.0", "92.242.223.255");
                ranges.AddRange("93.110.0.0", "93.110.255.255");
                ranges.AddRange("93.113.224.0", "93.113.239.255");
                ranges.AddRange("93.114.16.0", "93.114.31.255");
                ranges.AddRange("93.115.224.0", "93.115.239.255");
                ranges.AddRange("93.117.0.0", "93.117.31.255");
                ranges.AddRange("93.117.32.0", "93.117.47.255");
                ranges.AddRange("93.117.96.0", "93.117.127.255");
                ranges.AddRange("93.117.176.0", "93.117.191.255");
                ranges.AddRange("93.118.96.0", "93.118.127.255");
                ranges.AddRange("93.118.128.0", "93.118.159.255");
                ranges.AddRange("93.118.160.0", "93.118.175.255");
                ranges.AddRange("93.119.32.0", "93.119.63.255");
                ranges.AddRange("93.119.64.0", "93.119.95.255");
                ranges.AddRange("93.126.0.0", "93.126.63.255");
                ranges.AddRange("94.24.0.0", "94.24.15.255");
                ranges.AddRange("94.24.80.0", "94.24.95.255");
                ranges.AddRange("94.74.128.0", "94.74.191.255");
                ranges.AddRange("94.101.128.0", "94.101.143.255");
                ranges.AddRange("94.101.176.0", "94.101.191.255");
                ranges.AddRange("94.101.240.0", "94.101.255.255");
                ranges.AddRange("94.139.160.0", "94.139.175.255");
                ranges.AddRange("94.139.176.0", "94.139.191.255");
                ranges.AddRange("94.176.16.0", "94.176.31.255");
                ranges.AddRange("94.176.48.0", "94.176.63.255");
                ranges.AddRange("94.176.80.0", "94.176.95.255");
                ranges.AddRange("94.182.0.0", "94.183.255.255");
                ranges.AddRange("94.184.0.0", "94.184.127.255");
                ranges.AddRange("94.184.128.0", "94.184.255.255");
                ranges.AddRange("94.241.128.0", "94.241.191.255");
                ranges.AddRange("95.38.0.0", "95.38.255.255");
                ranges.AddRange("95.64.0.0", "95.64.127.255");
                ranges.AddRange("95.80.128.0", "95.80.191.255");
                ranges.AddRange("95.81.64.0", "95.81.127.255");
                ranges.AddRange("95.82.0.0", "95.82.63.255");
                ranges.AddRange("95.82.64.0", "95.82.127.255");
                ranges.AddRange("95.142.224.0", "95.142.239.255");
                ranges.AddRange("95.162.0.0", "95.162.255.255");
                ranges.AddRange("109.72.192.0", "109.72.207.255");
                ranges.AddRange("109.74.224.0", "109.74.239.255");
                ranges.AddRange("109.108.160.0", "109.108.191.255");
                ranges.AddRange("109.109.32.0", "109.109.63.255");
                ranges.AddRange("109.110.160.0", "109.110.191.255");
                ranges.AddRange("109.111.32.0", "109.111.63.255");
                ranges.AddRange("109.122.192.0", "109.122.223.255");
                ranges.AddRange("109.122.224.0", "109.122.255.255");
                ranges.AddRange("109.125.128.0", "109.125.159.255");
                ranges.AddRange("109.125.160.0", "109.125.191.255");
                ranges.AddRange("109.162.128.0", "109.162.255.255");
                ranges.AddRange("109.201.0.0", "109.201.31.255");
                ranges.AddRange("109.203.128.0", "109.203.159.255");
                ranges.AddRange("109.203.160.0", "109.203.191.255");
                ranges.AddRange("109.225.128.0", "109.225.191.255");
                ranges.AddRange("109.230.64.0", "109.230.127.255");
                ranges.AddRange("109.238.176.0", "109.238.191.255");
                ranges.AddRange("109.239.0.0", "109.239.15.255");
                ranges.AddRange("128.65.160.0", "128.65.175.255");
                ranges.AddRange("128.65.176.0", "128.65.191.255");
                ranges.AddRange("128.140.0.0", "128.140.127.255");
                ranges.AddRange("130.255.192.0", "130.255.255.255");
                ranges.AddRange("151.232.0.0", "151.235.255.255");
                ranges.AddRange("151.238.0.0", "151.239.255.255");
                ranges.AddRange("151.240.0.0", "151.247.255.255");
                ranges.AddRange("158.58.0.0", "158.58.127.255");
                ranges.AddRange("159.20.96.0", "159.20.111.255");
                ranges.AddRange("164.138.128.0", "164.138.191.255");
                ranges.AddRange("164.215.128.0", "164.215.255.255");
                ranges.AddRange("176.12.64.0", "176.12.79.255");
                ranges.AddRange("176.46.128.0", "176.46.159.255");
                ranges.AddRange("176.56.144.0", "176.56.159.255");
                ranges.AddRange("176.65.160.0", "176.65.191.255");
                ranges.AddRange("176.65.192.0", "176.65.255.255");
                ranges.AddRange("176.67.64.0", "176.67.79.255");
                ranges.AddRange("176.101.32.0", "176.101.47.255");
                ranges.AddRange("176.102.224.0", "176.102.255.255");
                ranges.AddRange("176.112.192.0", "176.112.223.255");
                ranges.AddRange("176.123.64.0", "176.123.127.255");
                ranges.AddRange("176.221.16.0", "176.221.31.255");
                ranges.AddRange("178.131.0.0", "178.131.255.255");
                ranges.AddRange("178.169.0.0", "178.169.31.255");
                ranges.AddRange("178.173.128.0", "178.173.191.255");
                ranges.AddRange("178.173.192.0", "178.173.223.255");
                ranges.AddRange("178.173.224.0", "178.173.255.255");
                ranges.AddRange("178.215.0.0", "178.215.63.255");
                ranges.AddRange("178.219.224.0", "178.219.239.255");
                ranges.AddRange("178.236.32.0", "178.236.47.255");
                ranges.AddRange("178.236.96.0", "178.236.111.255");
                ranges.AddRange("178.238.192.0", "178.238.207.255");
                ranges.AddRange("178.239.144.0", "178.239.159.255");
                ranges.AddRange("178.252.128.0", "178.252.191.255");
                ranges.AddRange("178.253.0.0", "178.253.63.255");
                ranges.AddRange("188.0.240.0", "188.0.255.255");
                ranges.AddRange("188.34.0.0", "188.34.255.255");
                ranges.AddRange("188.75.64.0", "188.75.127.255");
                ranges.AddRange("188.118.64.0", "188.118.127.255");
                ranges.AddRange("188.121.96.0", "188.121.127.255");
                ranges.AddRange("188.121.128.0", "188.121.159.255");
                ranges.AddRange("188.122.96.0", "188.122.127.255");
                ranges.AddRange("188.126.128.0", "188.126.159.255");
                ranges.AddRange("188.136.128.0", "188.136.255.255");
                ranges.AddRange("188.158.0.0", "188.159.255.255");
                ranges.AddRange("188.208.64.0", "188.208.95.255");
                ranges.AddRange("188.208.144.0", "188.208.159.255");
                ranges.AddRange("188.208.160.0", "188.208.191.255");
                ranges.AddRange("188.208.224.0", "188.208.255.255");
                ranges.AddRange("188.209.16.0", "188.209.31.255");
                ranges.AddRange("188.209.32.0", "188.209.47.255");
                ranges.AddRange("188.209.64.0", "188.209.79.255");
                ranges.AddRange("188.209.128.0", "188.209.143.255");
                ranges.AddRange("188.209.160.0", "188.209.191.255");
                ranges.AddRange("188.209.192.0", "188.209.207.255");
                ranges.AddRange("188.210.64.0", "188.210.79.255");
                ranges.AddRange("188.210.96.0", "188.210.127.255");
                ranges.AddRange("188.210.128.0", "188.210.191.255");
                ranges.AddRange("188.210.192.0", "188.210.207.255");
                ranges.AddRange("188.211.0.0", "188.211.15.255");
                ranges.AddRange("188.211.32.0", "188.211.63.255");
                ranges.AddRange("188.211.64.0", "188.211.127.255");
                ranges.AddRange("188.211.128.0", "188.211.159.255");
                ranges.AddRange("188.211.176.0", "188.211.191.255");
                ranges.AddRange("188.211.192.0", "188.211.223.255");
                ranges.AddRange("188.212.48.0", "188.212.63.255");
                ranges.AddRange("188.212.64.0", "188.212.95.255");
                ranges.AddRange("188.212.160.0", "188.212.191.255");
                ranges.AddRange("188.212.208.0", "188.212.223.255");
                ranges.AddRange("188.212.224.0", "188.212.239.255");
                ranges.AddRange("188.213.64.0", "188.213.79.255");
                ranges.AddRange("188.213.96.0", "188.213.127.255");
                ranges.AddRange("188.213.144.0", "188.213.159.255");
                ranges.AddRange("188.213.176.0", "188.213.191.255");
                ranges.AddRange("188.214.64.0", "188.214.79.255");
                ranges.AddRange("188.214.160.0", "188.214.191.255");
                ranges.AddRange("188.215.128.0", "188.215.143.255");
                ranges.AddRange("188.215.160.0", "188.215.191.255");
                ranges.AddRange("188.215.192.0", "188.215.223.255");
                ranges.AddRange("188.229.0.0", "188.229.127.255");
                ranges.AddRange("188.245.0.0", "188.245.255.255");
                ranges.AddRange("188.253.0.0", "188.253.31.255");
                ranges.AddRange("188.253.32.0", "188.253.63.255");
                ranges.AddRange("188.253.64.0", "188.253.95.255");
                ranges.AddRange("188.253.96.0", "188.253.127.255");
                ranges.AddRange("193.151.128.0", "193.151.159.255");
                ranges.AddRange("194.225.0.0", "194.225.255.255");
                ranges.AddRange("195.146.32.0", "195.146.63.255");
                ranges.AddRange("195.181.0.0", "195.181.31.255");
                ranges.AddRange("195.181.32.0", "195.181.63.255");
                ranges.AddRange("195.181.64.0", "195.181.127.255");
                ranges.AddRange("212.16.64.0", "212.16.95.255");
                ranges.AddRange("212.33.192.0", "212.33.207.255");
                ranges.AddRange("212.33.208.0", "212.33.223.255");
                ranges.AddRange("212.80.0.0", "212.80.31.255");
                ranges.AddRange("212.86.64.0", "212.86.95.255");
                ranges.AddRange("212.95.128.0", "212.95.143.255");
                ranges.AddRange("212.95.144.0", "212.95.159.255");
                ranges.AddRange("212.120.192.0", "212.120.223.255");
                ranges.AddRange("213.109.240.0", "213.109.255.255");
                ranges.AddRange("213.147.128.0", "213.147.159.255");
                ranges.AddRange("213.176.0.0", "213.176.31.255");
                ranges.AddRange("213.176.32.0", "213.176.63.255");
                ranges.AddRange("213.176.64.0", "213.176.127.255");
                ranges.AddRange("213.195.0.0", "213.195.31.255");
                ranges.AddRange("213.195.32.0", "213.195.47.255");
                ranges.AddRange("213.207.192.0", "213.207.207.255");
                ranges.AddRange("213.207.208.0", "213.207.223.255");
                ranges.AddRange("213.207.224.0", "213.207.255.255");
                ranges.AddRange("213.217.32.0", "213.217.63.255");
                ranges.AddRange("213.233.160.0", "213.233.191.255");
                ranges.AddRange("217.11.16.0", "217.11.31.255");
                ranges.AddRange("217.24.144.0", "217.24.159.255");
                ranges.AddRange("217.25.48.0", "217.25.63.255");
                ranges.AddRange("217.60.0.0", "217.60.255.255");
                ranges.AddRange("217.64.144.0", "217.64.159.255");
                ranges.AddRange("217.66.192.0", "217.66.207.255");
                ranges.AddRange("217.66.208.0", "217.66.223.255");
                ranges.AddRange("217.77.112.0", "217.77.127.255");
                ranges.AddRange("217.146.208.0", "217.146.223.255");
                ranges.AddRange("217.170.240.0", "217.170.255.255");
                ranges.AddRange("217.174.16.0", "217.174.31.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                ranges.AddRange("217.218.0.0", "217.219.255.255");
                isFilled = true;
            }
            return !ranges.CheckNumber(RemoteIpAddress.MapToIPv4().ToString());
        }
    };
}
